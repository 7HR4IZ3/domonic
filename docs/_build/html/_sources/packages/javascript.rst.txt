Domonic: Javascript
===================

There is a javascript package that mimics the js API.

This allows you to use javascript code you know within python i.e :

.. code-block :: python

	from domonic.javascript import Math
	print(Math.random()*10)
	print(Math.floor(Math.random()*100))

	from domonic.javascript import Array
	myArr=Array(1,2,3)
	print(myArr.splice(1))

	from domonic.javascript import URL
	url = URL('https://somesite.com/blog/article-one#some-hash')
	print(url.protocol)
	print(url.host)
	print(url.pathname)
	print(url.hash)

	# from domonic.javascript import Global
	# Global.decodeURIComponent(...
	# Global.encodeComponent(...

	mystr = String("Some String")
	print(mystr.toLowerCase())
	print(mystr.toUpperCase())
	print(mystr.length)

	# from domonic.javascript import Date
	# etc..


setInterval
----------------

You can use setInterval and clearInterval with params

.. code-block :: python

	x=0

	def hi(inc):
	    global x
	    x = x+inc
	    print(x)

	test = window.setInterval(hi, 1000, 2)
	import time
	time.sleep(5)
	window.clearInterval(test)
	print(f"Final value of x:{x}")



You can update a-tags the same way as it inherits from URL:

.. code-block :: python

	from domonic.html import *

	atag = a(_href="https://somesite.com:8000/blog/article-one#some-hash")
	print('href:',atag.href)
	print('protocol:',atag.protocol)
	print('port:',atag.port)

	atag.protocol = "http"
	atag.port = 8983
	print(atag)



There's a fetch implementation that uses promises. With additional mulithreaded and pooled versions.

.. code-block :: python

	from domonic.javascript import *

	urls = ['http://google.com', 'http://linkedin.com', 'http://eventual.technology']  # use your own domains

	print('run 1')
	results = window.fetch(urls[0])
	results.then(lambda r: print(r.text))
	print('run 1 FINISHED')

	def somefunc(response):
		print("I'm a callback", response.ok)
		return response

	mydata = window.fetch(urls[0]).then(somefunc)
	print(mydata)
	print(mydata.data)
	print(mydata.data.text)

	# fetch more than one
	results = window.fetch_set(urls)
	print(results)
	print(list(results))
	for r in results:
		if r is not None:
			print(r.ok)
			# print(r.text)

	# multi-threaded
	results = window.fetch_threaded(urls)
	print(results)
	print(list(results))
	for r in results:
		if r is not None:
			print(r.ok)
			# print(r.text)

	# pooled
	results = window.fetch_pooled(urls, timeout=2)
	print(results)
	for r in results:
		if r is not None:
			print(r.ok)
			# print(r.text)

	print('run 4')
	results = window.fetch(urls[0])
	print(results)
	results.then(lambda r: print(r.text) if r is not None else None)


All fetch methods use requests and will pass all the kwargs along should you need to modify


Styling
----------------

.. code-block :: python

	mytag = div("hi", _id="test")
	mytag.style.backgroundColor = "black"
	mytag.style.fontSize = "12px"
	print(mytag)
	# <div id="test" style="background-color:black;font-size:12px;">hi</div>


several other undocumented features. Take a look at the code.


.. automodule:: domonic.javascript
    :members:
    :noindex:

